#summary Throughput number for MCS
#labels v5.2.1BETA

= Introduction =

PF521BETA is testing the affects of the buffer size and number of channels on throughput. 


= Details =

We think there are two main factors that affect throughput

 # Number of CPUs on the workstations side
 # size of the buffer for each channel on the prop side.

At the current configuration, COG6 has 1K of its RAM allocated to buffer for the MCS Go-channels. This 1k is divided among the channels that COG6 is serving. COG6 watches the data stream, and send bytes to the buffer for each channel.  The cog on the watching the buffer consumes them as then appear, and spits characters back out. COG6 takes these and sends them back out on the data stream. 

 * A single channel has 1K buffer
 * 4 channels would have 256 bytes each
 * 8 channels have 128 bytes each
 * 16 channels have 64 bytes each
 * 32 channels have 32 bytes each

= Test Setup =

Please capture the numbers of CPUs when gomuxterm is launched

= Test commands =
PFv5.2.1BETA includes a test function to exercise the MCS serial for loopback, send and receive.  CONTROL-C launches the test menu. 

{{{
CONTROL PANEL
h       - prints help
?       - print status
q       - disconnect

nn c    - connects to channel nn as a telnet connection (CTL-c will invoke CONTROL PANEL)

n1 n2 s - run a loopback speed test on channel n1 for n2 bytes -- 4 <= n1 <= 32, 100 <= n2 <= 10000

n1 n2 t - run a send speed test on channel n1 for n2 bytes (data from prop) --  0 <= n1 <= 3, 100 <= n2 <= 10000

n1 n2 u - run a receive speed test on channel n1 for n2 bytes (data to prop) --  0 <= n1 <= 3, 100 <= n2 <= 10000
}}}

These are the test functions we want to run on all configurations. Send 5000 character over the channels, determine characters per second.

{{{
/ One channel loopback
6 5000 s
/ four channel loopback
4 5000 s 5 5000 s 6 5000 s 7 5000 s
 / one channel transmit
0 5000 t
/ four channel transmit
0 5000 t 1 5000 t 2 5000 t 3 5000 t
/one channel recieve
0 5000 u
/ four channel recieve
0 5000 u 1 5000 u 2 5000 u 3 5000 u
}}}

= Data collected =

Unit Under Test #: an ID for each text box listed; assigned in teh order received

Data is listed by number of CPU, processor speed, number of channels.

As of 20120525, there are 3 sets off data listed.

== one CPU ==

UUT1 - Intel Pentium 4 at 1.7Ghz (Evo) Windows XP

=== one CPU - 32 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 473.37
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 208.33
Mux Channel 05  Loop Chars/sec: 208.33
Mux Channel 06  Loop Chars/sec: 208.20
Mux Channel 07  Loop Chars/sec: 208.20

0 5000 t
Mux Channel 00 Send Chars/sec 471.98
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 01 Send Chars/sec 220.69
Mux Channel 00 Send Chars/sec 220.84
Mux Channel 03 Send Chars/sec 220.84
Mux Channel 02 Send Chars/sec 220.69

0 5000 u
Mux Channel 00  Rec Chars/sec 893.85
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 00  Rec Chars/sec 543.29
Mux Channel 02  Rec Chars/sec 543.29
Mux Channel 03  Rec Chars/sec 545.14
Mux Channel 01  Rec Chars/sec 544.22
}}}

=== one CPU - 16 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 649.09
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 228.41
Mux Channel 05  Loop Chars/sec: 228.41
Mux Channel 06  Loop Chars/sec: 228.41
Mux Channel 07  Loop Chars/sec: 228.25

0 5000 t
Mux Channel 00 Send Chars/sec 646.46
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 01 Send Chars/sec 235.81
Mux Channel 03 Send Chars/sec 235.47
Mux Channel 00 Send Chars/sec 235.29
Mux Channel 02 Send Chars/sec 235.47

0 5000 u
Mux Channel 00  Rec Chars/sec 1777.78
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 01  Rec Chars/sec 984.62
Mux Channel 00  Rec Chars/sec 984.62
Mux Channel 02  Rec Chars/sec 987.65
Mux Channel 03  Rec Chars/sec 981.60
}}}

=== one CPU - 8 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 740.74
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 239.52
Mux Channel 05  Loop Chars/sec: 238.98
Mux Channel 06  Loop Chars/sec: 238.98
Mux Channel 07  Loop Chars/sec: 238.81

0 5000 t
Mux Channel 00 Send Chars/sec 786.24
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 243.35
Mux Channel 03 Send Chars/sec 243.53
Mux Channel 01 Send Chars/sec 242.98
Mux Channel 02 Send Chars/sec 242.61

0 5000 u
Mux Channel 00  Rec Chars/sec 2000.00
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 01  Rec Chars/sec 1828.57
Mux Channel 03  Rec Chars/sec 1828.57
Mux Channel 02  Rec Chars/sec 1828.57
Mux Channel 00  Rec Chars/sec 1828.57
}}}

=== one CPU - 4 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 742.46
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 239.52
Mux Channel 05  Loop Chars/sec: 239.16
Mux Channel 06  Loop Chars/sec: 239.16
Mux Channel 07  Loop Chars/sec: 238.98

0 5000 t
Mux Channel 00 Send Chars/sec 786.24
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 243.53
Mux Channel 02 Send Chars/sec 243.35
Mux Channel 01 Send Chars/sec 243.35
Mux Channel 03 Send Chars/sec 242.79

0 5000 u
Mux Channel 00  Rec Chars/sec 2000.00
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 01  Rec Chars/sec 1849.71
Mux Channel 02  Rec Chars/sec 1849.71
Mux Channel 03  Rec Chars/sec 1849.71
Mux Channel 00  Rec Chars/sec 1849.71
}}}

=== one CPU - 1 channels ===

{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 740.74
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 239.34
Mux Channel 05  Loop Chars/sec: 239.34
Mux Channel 06  Loop Chars/sec: 239.16
Mux Channel 07  Loop Chars/sec: 238.98

0 5000 t
Mux Channel 00 Send Chars/sec 786.24
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 243.16
Mux Channel 01 Send Chars/sec 243.16
Mux Channel 02 Send Chars/sec 242.79
Mux Channel 03 Send Chars/sec 242.61

0 5000 u
Mux Channel 00  Rec Chars/sec 2000.00
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 00  Rec Chars/sec 1871.35
Mux Channel 01  Rec Chars/sec 1871.35
Mux Channel 02  Rec Chars/sec 1871.35
Mux Channel 03  Rec Chars/sec 1882.35
}}}

== UUT3 - one CPU ==

UUT3 - AMD Athlon 64 3000 at 1.8Ghz - 1 CPU Windows XP

=== UUT3 - one CPU - 32 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 804.02
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 492.31
Mux Channel 05  Loop Chars/sec: 492.31
Mux Channel 06  Loop Chars/sec: 492.31
Mux Channel 07  Loop Chars/sec: 492.31
0 5000 t
Mux Channel 00 Send Chars/sec 812.18
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 804.02
Mux Channel 03 Send Chars/sec 794.04
Mux Channel 01 Send Chars/sec 794.04
Mux Channel 02 Send Chars/sec 802.01
0 5000 u
Mux Channel 00  Rec Chars/sec 822.62
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 03  Rec Chars/sec 543.29
Mux Channel 00  Rec Chars/sec 543.29
Mux Channel 01  Rec Chars/sec 542.37
Mux Channel 02  Rec Chars/sec 542.37
}}}

=== UUT3 - one CPU - 16 channels === 
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 1509.43
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 924.86
Mux Channel 05  Loop Chars/sec: 924.86
Mux Channel 06  Loop Chars/sec: 927.54
Mux Channel 07  Loop Chars/sec: 927.54
0 5000 t
Mux Channel 00 Send Chars/sec 1675.39
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 1509.43
Mux Channel 01 Send Chars/sec 1502.35
Mux Channel 02 Send Chars/sec 1502.35
Mux Channel 03 Send Chars/sec 1481.48
0 5000 u
Mux Channel 00  Rec Chars/sec 1624.37
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 00  Rec Chars/sec 963.86
Mux Channel 01  Rec Chars/sec 963.86
Mux Channel 03  Rec Chars/sec 963.86
Mux Channel 02  Rec Chars/sec 960.96
}}}

=== UUT3 - one CPU - 8 channels === 
{{{ 
6 5000 s
Mux Channel 06  Loop Chars/sec: 1987.58
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 1447.96
Mux Channel 05  Loop Chars/sec: 1447.96
Mux Channel 06  Loop Chars/sec: 1447.96
Mux Channel 07  Loop Chars/sec: 1447.96
0 5000 t
Mux Channel 00 Send Chars/sec 3106.80
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 2622.95
Mux Channel 03 Send Chars/sec 2560.00
Mux Channel 02 Send Chars/sec 2560.00
Mux Channel 01 Send Chars/sec 2539.68
0 5000 u
Mux Channel 00  Rec Chars/sec 1975.31
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 00  Rec Chars/sec 1939.39
Mux Channel 02  Rec Chars/sec 1939.39
Mux Channel 03  Rec Chars/sec 1939.39
Mux Channel 01  Rec Chars/sec 1939.39
}}}

=== UUT3 - one CPU - 4 channels === 
{{{ 
6 5000 s
Mux Channel 06  Loop Chars/sec: 1951.22
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 1454.55
Mux Channel 05  Loop Chars/sec: 1454.55
Mux Channel 06  Loop Chars/sec: 1454.55
Mux Channel 07  Loop Chars/sec: 1454.55
0 5000 t
Mux Channel 00 Send Chars/sec 3106.80
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 01 Send Chars/sec 2560.00
Mux Channel 00 Send Chars/sec 2560.00
Mux Channel 03 Send Chars/sec 2424.24
Mux Channel 02 Send Chars/sec 2424.24
0 5000 u
Mux Channel 00  Rec Chars/sec 2012.58
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 02  Rec Chars/sec 1951.22
Mux Channel 01  Rec Chars/sec 1951.22
Mux Channel 00  Rec Chars/sec 1963.19
Mux Channel 03  Rec Chars/sec 1963.19
}}}
=== UUT3 - one CPU - 1 channels === 
{{{ 
6 5000 s
Mux Channel 06  Loop Chars/sec: 1916.17
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 1516.59
Mux Channel 05  Loop Chars/sec: 1516.59
Mux Channel 06  Loop Chars/sec: 1516.59
Mux Channel 07  Loop Chars/sec: 1516.59
0 5000 t
Mux Channel 00 Send Chars/sec 3076.92
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 02 Send Chars/sec 2560.00
Mux Channel 00 Send Chars/sec 2560.00
Mux Channel 03 Send Chars/sec 2560.00
Mux Channel 01 Send Chars/sec 2560.00
0 5000 u
Mux Channel 00  Rec Chars/sec 1939.39
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 00  Rec Chars/sec 1975.31
Mux Channel 01  Rec Chars/sec 1975.31
Mux Channel 02  Rec Chars/sec 1975.31
Mux Channel 03  Rec Chars/sec 1975.31
}}}


== TWO CPU ==

UUT2 - Intel E6750 at 3.4 Ghz Windows XP

=== TWO CPUS - 32 channels ===

{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 855.61
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 04  Loop Chars/sec: 492.31
Mux Channel 07  Loop Chars/sec: 491.55
Mux Channel 06  Loop Chars/sec: 490.80
Mux Channel 05  Loop Chars/sec: 490.05
0 5000 t
Mux Channel 00 Send Chars/sec 883.98
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 869.57
Mux Channel 03 Send Chars/sec 860.22
Mux Channel 02 Send Chars/sec 855.61
Mux Channel 01 Send Chars/sec 844.33
0 5000 u
Mux Channel 00  Rec Chars/sec 891.36
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 01  Rec Chars/sec 560.42
Mux Channel 02  Rec Chars/sec 560.42
Mux Channel 03  Rec Chars/sec 559.44
Mux Channel 00  Rec Chars/sec 557.49
}}}

=== TWO CPUS - 16 channels ===

{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 1729.73
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 06  Loop Chars/sec: 987.65
Mux Channel 04  Loop Chars/sec: 987.65
Mux Channel 05  Loop Chars/sec: 987.65
Mux Channel 07  Loop Chars/sec: 987.65
0 5000 t
Mux Channel 00 Send Chars/sec 1758.24
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 1616.16
Mux Channel 03 Send Chars/sec 1624.37
Mux Channel 02 Send Chars/sec 1600.00
Mux Channel 01 Send Chars/sec 1608.04
0 5000 u
Mux Channel 00  Rec Chars/sec 1777.78
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 03  Rec Chars/sec 993.79
Mux Channel 00  Rec Chars/sec 987.65
Mux Channel 02  Rec Chars/sec 984.62
Mux Channel 01  Rec Chars/sec 987.65
}}}

=== TWO CPUS - 8 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 2000.00
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 05  Loop Chars/sec: 1428.57
Mux Channel 06  Loop Chars/sec: 1428.57
Mux Channel 04  Loop Chars/sec: 1428.57
Mux Channel 07  Loop Chars/sec: 1428.57
0 5000 t
Mux Channel 00 Send Chars/sec 3265.31
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 2831.86
Mux Channel 02 Send Chars/sec 2711.86
Mux Channel 03 Send Chars/sec 2689.08
Mux Channel 01 Send Chars/sec 2666.67
0 5000 u
Mux Channel 00  Rec Chars/sec 2012.58
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 03  Rec Chars/sec 1987.58
Mux Channel 02  Rec Chars/sec 1987.58
Mux Channel 00  Rec Chars/sec 2000.00
Mux Channel 01  Rec Chars/sec 2000.00

}}}

=== TWO CPUS - 4 channels ===

{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 2000.00
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 05  Loop Chars/sec: 1474.65
Mux Channel 04  Loop Chars/sec: 1474.65
Mux Channel 07  Loop Chars/sec: 1474.65
Mux Channel 06  Loop Chars/sec: 1474.65
0 5000 t
Mux Channel 00 Send Chars/sec 3298.97
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 01 Send Chars/sec 2711.86
Mux Channel 00 Send Chars/sec 2666.67
Mux Channel 02 Send Chars/sec 2666.67
Mux Channel 03 Send Chars/sec 2644.63
0 5000 u
Mux Channel 00  Rec Chars/sec 2012.58
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 00  Rec Chars/sec 1987.58
Mux Channel 03  Rec Chars/sec 2000.00
Mux Channel 01  Rec Chars/sec 2000.00
Mux Channel 02  Rec Chars/sec 1987.58

}}}
=== TWO CPUS - 1 channels ===
{{{
6 5000 s
Mux Channel 06  Loop Chars/sec: 2000.00
4 5000 s 5 5000 s 6 5000 s 7 5000 s
Mux Channel 05  Loop Chars/sec: 1560.98
Mux Channel 04  Loop Chars/sec: 1560.98
Mux Channel 06  Loop Chars/sec: 1560.98
Mux Channel 07  Loop Chars/sec: 1560.98
0 5000 t
Mux Channel 00 Send Chars/sec 3200.00
0 5000 t 1 5000 t 2 5000 t 3 5000 t
Mux Channel 00 Send Chars/sec 2909.09
Mux Channel 02 Send Chars/sec 2882.88
Mux Channel 01 Send Chars/sec 2807.02
Mux Channel 03 Send Chars/sec 2758.62
0 5000 u
Mux Channel 00  Rec Chars/sec 2012.58
0 5000 u 1 5000 u 2 5000 u 3 5000 u
Mux Channel 02  Rec Chars/sec 2000.00
Mux Channel 01  Rec Chars/sec 2000.00
Mux Channel 03  Rec Chars/sec 2000.00
Mux Channel 00  Rec Chars/sec 2000.00
}}}

== Four CPUs ==

=== Four CPUs - 32 channels ===
=== Four CPUs - 16 channels ===
=== Four CPUs - 8 channels ===
=== Four CPUs - 4 channels ===
=== Four CPUs - 1 channels ===

== n CPU ==

Can we guess using the above data?  No.

=== n CPU - 32 channels ===
=== n CPU - 16 channels ===
=== n CPU - 8 channels ===
=== n CPU - 4 channels ===
=== n CPU - 1 channels ===

-----

= Summary =

The data might be saying this:

 * Above 1.8 Ghz, the workstation is fast enough to saturate the asynchronous serial connection
 * the maximum throughput for this test (synchronous serial protocol over asynchronous serial comport hardware) should be around 2000 cps, some numbers come out above that due to the timing of the ways the data is collected (*Or I got this wrong, and the numbers can be way higher)  
 * we start to notice the impact of multiple channels above 8 channels at 16 channels, where send and receive tests are both below 2000 cps on a 1.8Ghz workstation
 * 16 channels is still 75% of maximum; 32 channels is 40% maximum.  We can set up future experiments to run 32 channels, and talk to all the cogs on 4 physical prop chips at the same time, or 32 prop chips through 1 cog.  If more speed (higher cps throughput) is needed we can drop back to 16 channels.  
 
-- End 20120525 --