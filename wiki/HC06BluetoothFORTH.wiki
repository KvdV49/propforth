#summary Forth scripts to configure HC06.

= FORTH scripts for initializing and configuring the HC06 =

The HC06 Bluetooth serial replacement modules need configuration from the default.  By default the modules are set to a slow 9600 baud, and all have the same name depending on the manufacturer.  

We set them to a unique new and the Propforth standard 230400 baud. 

== load the default communication for 9600 ==

Start with the easy part:

{{{
fl

\ for the HC06

\ green wire - this is not used on the carrier mounted modules
1 wconstant hcProgPin 

\ white/orange wire - QSbot RXD to p27
27 wconstant hcRx

\ white/green wire - QSbot TXD to p26
26 wconstant hcTx

\  initally they come up at 9600,  switch this after we set it to 230400

 9600 4/ wconstant hcBaud
\ 230400 4/ wconstant hcBaud 

0 wconstant hcSerialCog

hcSerialCog cogreset 100 delms
c" hcRx hcTx hcBaud serial" hcSerialCog cogx 100 delms


: hcSend
        cogid hcSerialCog iolink .cstr 1000 delms cogid iounlink cr
;

\ NOTE:  last batch of modules need a SPACE and CR after the command!!!
: hcSendcr
        cogid hcSerialCog iolink .cstr space cr 1000 delms cogid iounlink cr
;

hcProgPin pinhi hcProgPin pinout




\ REMEMBER the HC06 LED must be blinking!
\ If it isn't blinking, disconnect HC06 Gnd, and reconnect. It will blink
\ If it isn't blinking, disconnect HC06 Vcc, and reconnect. It will blink
}}}


The above gets loaded automatically by boot.f 
* NO, auto boot.f at this point just gets confusing. Do all this manually with cut and paste *

-----


=== Verify the device is communicating ===

This part we do manually.  Copy and paste each lf therse three lines, one at a time.

{{{
c" AT" hcSend

c" AT+VERSION" hcSend

c" AT" hcSendcr

c" AT+VERSION" hcSendcr
}}}

NOTE:  This was an error: 'c" AT+NAME?" hcSend' as it changes the device name to '?'

This does NOT echo the name: 'c" AT+NAME" hcSend'

The way to see the name after it is set is via the bluetooth paring screen on the android device, only.

After the HC06 responds to 

 * c" AT" hcSend    with OK 
 * c" AT+VERSION" hcSend with  OKlinvorV1.8  
 * c" AT+NAMElittlerobotnewname" hcSend  with OKsetname

You are ready to configure. 

=== Set the device to a name of your choice ===

Copy the following into an editor and  set the name correctly.  I used *CPL-01-of-12* here as I have a bunch of these to do before the next workshop. 

Send the commands one at a time 

{{{
c" AT" hcSend
c" AT+VERSION" hcSend
c" AT+NAMEQSbot-CPL-01-of-12" hcSend
c" AT+PIN1234" hcSend
c" AT+PN" hcSend
}}}

The above should set the name of the device (that is displayed on the Android Bluetooth Device panel), and make the pin code / password to 1234

-----

=== Change the BAUD to 230400 LAST ===

After the device is all ready go to, we change the BAUD LAST

This will change the transmission rate from a fast 9600 default baud to the very fast 230400 baud. 

{{{
\ note baud change immediately on hc06!!!!!
\ don't do this until you've set everything else.
\ c" AT+BAUD9" hcSend
c" AT+BAUD9" hcSend
}}}

-----

=== Power cycle and 230400 communication ===

AFTER YOU CHANGE THE HC06 BAUD to 23040, power cycle the prop and HC06.

Pull the Vcc wire again, and reconnect, to get the RED programming LED to flash again. 

Check the the HC06 is in fact programmed to run and 230400 with the followwing:

{{{
fl

\ REMEMBER the HC06 LED must be blinking!
\ If it isn't , disconnect Gnd, and reconnect. It will blink

\ for the HC06

\ green wire - this is not used on the carrier mounted modules
1 wconstant hcProgPin 

\ white/orange wire - QSbot RXD to p27
27 wconstant hcRx

\ white/green wire - QSbot TXD to p26
26 wconstant hcTx

\  initally they come up at 9600,  switch this after we set it to 230400

\ 9600 4/ wconstant hcBaud
230400 4/ wconstant hcBaud  \ NOW we are 230400 !!!

0 wconstant hcSerialCog

hcSerialCog cogreset 100 delms
c" hcRx hcTx hcBaud serial" hcSerialCog cogx 100 delms


: hcSend
        cogid hcSerialCog iolink .cstr 1000 delms cogid iounlink cr
;

hcProgPin pinhi hcProgPin pinout


}}}


Notice that this is sets 230400 baud, otherswise its the same as before.

Do the same diagnositc queries as above 

{{{
c" AT" hcSend

c" AT+VERSION" hcSend
}}}

 * Both should respond with OK, and the HC06 is set. 


= Details =

Add your content here.  Format your content with:
  * Text in *bold* or _italic_
  * Headings, paragraphs, and lists
  * Automatic links to other wiki pages