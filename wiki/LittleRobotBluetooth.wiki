#summary HC05 and HC06 Bluetooth for Little Robot(tm)
#labels v5.3,LittleRobot,bluetooth,v5.5

<wiki:toc max_depth="9" />

= Introduction =

The HC05 and HC06  Bluetooth module allows communication with the prop via bluetooth.  No cables are needed after initial programming. 

This pages covers the immediate set up steps for the HC06.  If you have problems, or want to use the hc05, see

http://code.google.com/p/propforth/wiki/LittleRobotBluetoothDETAILS

for addditional details.

= HC06 =

The workshop is using the HC06 modules mounted on a 6 pin carrier board.  only Vcc (3.3v), GND, Rxd and Txd are used.

= Configuration Script =

The following is a modification of the script found in bot.f

NOTICE this script is undergoing maintenance, do not use.

{{{
fl

fswrite boot.f

hA state orC! version W@ .cstr cr cr cr
: findEETOP
0
h100000 h8000
do
i t0 2 eereadpage
if
leave
else
i h7FFE + t0 3 eereadpage
if
leave
else
drop i h8000 +
then
then
h8000 +loop
;

c" boot.f - Finding top of eeprom, " .cstr findEETOP ' fstop 2+ alignl L! forget findEETOP c" Top of eeprom at: " .cstr fstop . cr
c" boot.f - Loading QSbotHC06.f~h0D~h0D" .cstr hA state andnC!
fsload QSbotHC06.f
c" boot.f - Loaded QSbotHC06.f~h0D~h0D" .cstr hA state andnC!
c" boot.f - DONE PropForth Loaded~h0D~h0D" .cstr hA state andnC!
...


fswrite QSbotHC06.f

\ for the HC06

1 wconstant hcProgPin
26 wconstant hcTx
27 wconstant hcRx

c" QSbotHC06 " prop W@ ccopy
1 propid W!



: onreset6
fkey? and fkey? and or h1B <>
if
$S_con iodis $S_con cogreset 100 delms
\ c" _ready_led dup pinout pinhi" $S_con cogx
c" hcRx hcTx 57600 serial" $S_con cogx 100 delms
cogid >con
\ c" init_motorA" 0 cogx
\ c" init_motorB" 1 cogx
\ c" _sr04_measure" 2 cogx
then

fsls

c" onreset6" (forget)
;


...



fswrite btstat.f


230400 4/ wconstant hcBaud

0 wconstant hcSerialCog

hcSerialCog cogreset 100 delms
c" hcRx hcTx hcBaud serial" hcSerialCog cogx 100 delms
1 hcSerialCog sersetflags


: hcSend
	cogid hcSerialCog iolink .cstr 1000 delms cogid iounlink cr
;

hcProgPin pinhi hcProgPin pinout

c" AT+VERSION~h0D~h0A" hcSend
c" AT+ROLE?~h0D~h0A" hcSend
c" AT+UART?~h0D~h0A" hcSend
c" AT+NAME?~h0D~h0A" hcSend
c" AT+PSWD?~h0D~h0A" hcSend

hcProgPin pinlo 

...

fswrite btinit.f

hcProgPin pinhi hcProgPin pinout

c" AT+NAME=CPL01of12~h0D~h0A" hcSend
c" AT+PSWD=1234~h0D~h0A" hcSend
c" AT+UART=230400,0,0~h0D~h0A" hcSend
c" AT+VERSION~h0D~h0A" hcSend
c" AT+ROLE?~h0D~h0A" hcSend
c" AT+UART?~h0D~h0A" hcSend
c" AT+NAME?~h0D~h0A" hcSend
c" AT+PSWD?~h0D~h0A" hcSend

hcProgPin pinlo 

\ HC05: after the hc05 is power cycled, the baud rate will change, not like the hc06
\ HC06: Baud changes immediately. Change BAUD LAST

...

cr


}}}

-----

= Pair the devices =

The HC05 should be visible as a slave (pairable) device when re-powered

== Windows XP ==

Run Blue Tooth Wizard 

The wizard should find a device, and display the name you provided in the the script. 

Enter your pin (as you assigned in the script, or 1234 if you left the default)

XP will add two COM ports, on incoming and one out going. 

The outgoing port is the one you will use with Teraterm.  The incoming port doesn't do anything, but has to be there. 

== Android ==

  * Select Settings.  
  * Under (or near) WiFi find Bluetooth. 
  * select "Search for Devices" (upper right corner on Nexus)

You should see an eight(?) hex value address displayed very quickly. 

A short time later this will change to the name you assigned in the script.

Select this, and enter your pin you define in the script, or 1234 if you left the default.

=== Blueterm ===

You can now connect to this device using Blue term (the three dots in the lower right corner is the secret!)


= NOTES =

- end -